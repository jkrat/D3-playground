{"ast":null,"code":"var _jsxFileName = \"/Users/jim/Source/CD/JavaScript/D3/D3-playground/src/components/PieCharts/DynamicDonut/index.jsx\";\nimport React, { useEffect } from 'react';\nimport * as d3 from 'd3';\nconst width = 960;\nconst height = Math.min(width, 500);\nconst radius = height / 2;\nconst color = d3.scaleOrdinal(['#bab0ab'].concat(d3.schemeTableau10));\nlet chart;\n\nconst pieGenerator = values => d3.pie().sort(null).value(d => d)(values);\n\nconst arcGenerator = d3.arc().innerRadius(radius * 0.67).outerRadius(radius - 1);\n\nconst DynamicDonut = ({\n  data\n}) => {\n  const initialData = [];\n  initialData.push(1);\n\n  for (let i = 0; i < data.length; i++) {\n    initialData.push(0);\n  }\n\n  useEffect(() => {\n    chart = d3.select('#DynamicDonut').attr('viewBox', [-487.5, -250, 975, 500]).append('g');\n  }, []);\n  useEffect(() => {\n    createChart(initialData);\n    setTimeout(function () {\n      const chartData = [0].concat(data);\n      createChart(chartData);\n    }, 1);\n  }, [data]);\n\n  function createChart(dataSet) {\n    const t = d3.transition().duration(1000);\n    const arcs = pieGenerator(dataSet);\n    const path = chart.datum(dataSet).selectAll('path').data(arcs);\n    path.join(enter => enter.append('path').attr('fill', (d, i) => color(i)).attr('d', arcGenerator).each(function (d) {\n      this.current = d;\n    }).call(enter => enter.transition(t).attrTween('d', arcTween)), update => update.transition(t).attrTween('d', arcTween), exit => exit.remove());\n  }\n\n  function arcTween(a) {\n    const i = d3.interpolate(this._current, a);\n    this._current = i(0);\n    return t => arcGenerator(i(t));\n  }\n\n  return React.createElement(\"svg\", {\n    id: \"DynamicDonut\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 73\n    },\n    __self: this\n  });\n};\n\nexport default DynamicDonut;","map":{"version":3,"sources":["/Users/jim/Source/CD/JavaScript/D3/D3-playground/src/components/PieCharts/DynamicDonut/index.jsx"],"names":["React","useEffect","d3","width","height","Math","min","radius","color","scaleOrdinal","concat","schemeTableau10","chart","pieGenerator","values","pie","sort","value","d","arcGenerator","arc","innerRadius","outerRadius","DynamicDonut","data","initialData","push","i","length","select","attr","append","createChart","setTimeout","chartData","dataSet","t","transition","duration","arcs","path","datum","selectAll","join","enter","each","current","call","attrTween","arcTween","update","exit","remove","a","interpolate","_current"],"mappings":"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","sourcesContent":["import React, { useEffect } from 'react';\nimport * as d3 from 'd3';\n\nconst width = 960;\nconst height = Math.min(width, 500);\nconst radius = height / 2;\n\nconst color = d3.scaleOrdinal(['#bab0ab'].concat(d3.schemeTableau10));\nlet chart;\n\nconst pieGenerator = values =>\n  d3\n    .pie()\n    .sort(null)\n    .value(d => d)(values);\n\nconst arcGenerator = d3\n  .arc()\n  .innerRadius(radius * 0.67)\n  .outerRadius(radius - 1);\n\nconst DynamicDonut = ({ data }) => {\n  const initialData = [];\n  initialData.push(1);\n  for (let i = 0; i < data.length; i++) {\n    initialData.push(0);\n  }\n\n  useEffect(() => {\n    chart = d3\n      .select('#DynamicDonut')\n      .attr('viewBox', [-487.5, -250, 975, 500])\n      .append('g');\n  }, []);\n\n  useEffect(() => {\n    createChart(initialData);\n    setTimeout(function() {\n      const chartData = [0].concat(data);\n      createChart(chartData);\n    }, 1);\n  }, [data]);\n\n  function createChart(dataSet) {\n    const t = d3.transition().duration(1000);\n    const arcs = pieGenerator(dataSet);\n    const path = chart\n      .datum(dataSet)\n      .selectAll('path')\n      .data(arcs);\n\n    path.join(\n      enter =>\n        enter\n          .append('path')\n          .attr('fill', (d, i) => color(i))\n          .attr('d', arcGenerator)\n          .each(function(d) {\n            this.current = d;\n          })\n          .call(enter => enter.transition(t).attrTween('d', arcTween)),\n      update => update.transition(t).attrTween('d', arcTween),\n      exit => exit.remove()\n    );\n  }\n\n  function arcTween(a) {\n    const i = d3.interpolate(this._current, a);\n    this._current = i(0);\n    return t => arcGenerator(i(t));\n  }\n\n  return <svg id=\"DynamicDonut\" />;\n};\n\nexport default DynamicDonut;\n"]},"metadata":{},"sourceType":"module"}