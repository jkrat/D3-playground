{"ast":null,"code":"import * as d3 from 'd3';\nexport const d4 = {\n  bullet: function () {\n    var orient = 'left',\n        reverse = false,\n        duration = 0,\n        ranges = bulletRanges,\n        markers = bulletMarkers,\n        measures = bulletMeasures,\n        width = 380,\n        height = 30,\n        tickFormat = null;\n\n    function bullet(g) {\n      g.each(function (d, i) {\n        var rangez = ranges.call(this, d, i).slice().sort(d3.descending),\n            markerz = markers.call(this, d, i).slice().sort(d3.descending),\n            measurez = measures.call(this, d, i).slice().sort(d3.descending),\n            g = d3.select(this); // Compute the new x-scale.\n\n        var x1 = d3.scaleLinear().domain([0, Math.max(rangez[0], markerz[0], measurez[0])]).range(reverse ? [width, 0] : [0, width]); // Retrieve the old x-scale, if this is an update.\n\n        var x0 = this.__chart__ || d3.scaleLinear().domain([0, Infinity]).range(x1.range()); // Stash the new scale.\n\n        this.__chart__ = x1; // Derive width-scales from the x-scales.\n\n        var w0 = bulletWidth(x0),\n            w1 = bulletWidth(x1); // Update the range rects.\n\n        var range = g.selectAll('rect.range').data(rangez);\n        range.enter().append('rect').attr('class', function (d, i) {\n          return 'range s' + i;\n        }).attr('width', w0).attr('height', height).attr('x', reverse ? x0 : 0).transition().duration(duration).attr('width', w1).attr('x', reverse ? x1 : 0);\n        range.transition().duration(duration).attr('x', reverse ? x1 : 0).attr('width', w1).attr('height', height); // Update the measure rects.\n\n        var measure = g.selectAll('rect.measure').data(measurez);\n        measure.enter().append('rect').attr('class', function (d, i) {\n          return 'measure s' + i;\n        }).attr('width', w0).attr('height', height / 3).attr('x', reverse ? x0 : 0).attr('y', height / 3).transition().duration(duration).attr('width', w1).attr('x', reverse ? x1 : 0);\n        measure.transition().duration(duration).attr('width', w1).attr('height', height / 3).attr('x', reverse ? x1 : 0).attr('y', height / 3); // Update the marker lines.\n\n        var marker = g.selectAll('line.marker').data(markerz);\n        marker.enter().append('line').attr('class', 'marker').attr('x1', x0).attr('x2', x0).attr('y1', height / 6).attr('y2', height * 5 / 6).transition().duration(duration).attr('x1', x1).attr('x2', x1);\n        marker.transition().duration(duration).attr('x1', x1).attr('x2', x1).attr('y1', height / 6).attr('y2', height * 5 / 6); // Compute the tick format.\n\n        var format = tickFormat || x1.tickFormat(8); // Update the tick groups.\n\n        var tick = g.selectAll('g.tick').data(x1.ticks(8), function (d) {\n          return this.textContent || format(d);\n        }); // Initialize the ticks with the old scale, x0.\n\n        var tickEnter = tick.enter().append('g').attr('class', 'tick').attr('transform', bulletTranslate(x0)).style('opacity', 1e-6);\n        tickEnter.append('line').attr('y1', height).attr('y2', height * 7 / 6);\n        tickEnter.append('text').attr('text-anchor', 'middle').attr('dy', '1em').attr('y', height * 7 / 6).text(format); // Transition the entering ticks to the new scale, x1.\n\n        tickEnter.transition().duration(duration).attr('transform', bulletTranslate(x1)).style('opacity', 1); // Transition the updating ticks to the new scale, x1.\n\n        var tickUpdate = tick.transition().duration(duration).attr('transform', bulletTranslate(x1)).style('opacity', 1);\n        tickUpdate.select('line').attr('y1', height).attr('y2', height * 7 / 6);\n        tickUpdate.select('text').attr('y', height * 7 / 6); // Transition the exiting ticks to the new scale, x1.\n\n        tick.exit().transition().duration(duration).attr('transform', bulletTranslate(x1)).style('opacity', 1e-6).remove();\n      });\n      d3.timerFlush();\n    } // left, right, top, bottom\n\n\n    bullet.orient = function (x) {\n      if (!arguments.length) return orient;\n      orient = x;\n      reverse = orient == 'right' || orient == 'bottom';\n      return bullet;\n    }; // ranges (bad, satisfactory, good)\n\n\n    bullet.ranges = function (x) {\n      if (!arguments.length) return ranges;\n      ranges = x;\n      return bullet;\n    }; // markers (previous, goal)\n\n\n    bullet.markers = function (x) {\n      if (!arguments.length) return markers;\n      markers = x;\n      return bullet;\n    }; // measures (actual, forecast)\n\n\n    bullet.measures = function (x) {\n      if (!arguments.length) return measures;\n      measures = x;\n      return bullet;\n    };\n\n    bullet.width = function (x) {\n      if (!arguments.length) return width;\n      width = x;\n      return bullet;\n    };\n\n    bullet.height = function (x) {\n      if (!arguments.length) return height;\n      height = x;\n      return bullet;\n    };\n\n    bullet.tickFormat = function (x) {\n      if (!arguments.length) return tickFormat;\n      tickFormat = x;\n      return bullet;\n    };\n\n    bullet.duration = function (x) {\n      if (!arguments.length) return duration;\n      duration = x;\n      return bullet;\n    };\n\n    return bullet;\n  }\n};\n\nfunction bulletRanges(d) {\n  return d.ranges;\n}\n\nfunction bulletMarkers(d) {\n  return d.markers;\n}\n\nfunction bulletMeasures(d) {\n  return d.measures;\n}\n\nfunction bulletTranslate(x) {\n  return function (d) {\n    return 'translate(' + x(d) + ',0)';\n  };\n}\n\nfunction bulletWidth(x) {\n  var x0 = x(0);\n  return function (d) {\n    return Math.abs(x(d) - x0);\n  };\n}","map":{"version":3,"sources":["/Users/jim/Source/CD/JavaScript/D3/D3-playground/src/components/BarCharts/BulletChart/bullet.js"],"names":["d3","d4","bullet","orient","reverse","duration","ranges","bulletRanges","markers","bulletMarkers","measures","bulletMeasures","width","height","tickFormat","g","each","d","i","rangez","call","slice","sort","descending","markerz","measurez","select","x1","scaleLinear","domain","Math","max","range","x0","__chart__","Infinity","w0","bulletWidth","w1","selectAll","data","enter","append","attr","transition","measure","marker","format","tick","ticks","textContent","tickEnter","bulletTranslate","style","text","tickUpdate","exit","remove","timerFlush","x","arguments","length","abs"],"mappings":"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","sourcesContent":["import * as d3 from 'd3';\n\nexport const d4 = {\n  bullet: function() {\n    var orient = 'left',\n      reverse = false,\n      duration = 0,\n      ranges = bulletRanges,\n      markers = bulletMarkers,\n      measures = bulletMeasures,\n      width = 380,\n      height = 30,\n      tickFormat = null;\n\n    function bullet(g) {\n      g.each(function(d, i) {\n        var rangez = ranges\n            .call(this, d, i)\n            .slice()\n            .sort(d3.descending),\n          markerz = markers\n            .call(this, d, i)\n            .slice()\n            .sort(d3.descending),\n          measurez = measures\n            .call(this, d, i)\n            .slice()\n            .sort(d3.descending),\n          g = d3.select(this);\n\n        // Compute the new x-scale.\n        var x1 = d3\n          .scaleLinear()\n          .domain([0, Math.max(rangez[0], markerz[0], measurez[0])])\n          .range(reverse ? [width, 0] : [0, width]);\n\n        // Retrieve the old x-scale, if this is an update.\n        var x0 =\n          this.__chart__ ||\n          d3\n            .scaleLinear()\n            .domain([0, Infinity])\n            .range(x1.range());\n\n        // Stash the new scale.\n        this.__chart__ = x1;\n\n        // Derive width-scales from the x-scales.\n        var w0 = bulletWidth(x0),\n          w1 = bulletWidth(x1);\n\n        // Update the range rects.\n        var range = g.selectAll('rect.range').data(rangez);\n\n        range\n          .enter()\n          .append('rect')\n          .attr('class', function(d, i) {\n            return 'range s' + i;\n          })\n          .attr('width', w0)\n          .attr('height', height)\n          .attr('x', reverse ? x0 : 0)\n          .transition()\n          .duration(duration)\n          .attr('width', w1)\n          .attr('x', reverse ? x1 : 0);\n\n        range\n          .transition()\n          .duration(duration)\n          .attr('x', reverse ? x1 : 0)\n          .attr('width', w1)\n          .attr('height', height);\n\n        // Update the measure rects.\n        var measure = g.selectAll('rect.measure').data(measurez);\n\n        measure\n          .enter()\n          .append('rect')\n          .attr('class', function(d, i) {\n            return 'measure s' + i;\n          })\n          .attr('width', w0)\n          .attr('height', height / 3)\n          .attr('x', reverse ? x0 : 0)\n          .attr('y', height / 3)\n          .transition()\n          .duration(duration)\n          .attr('width', w1)\n          .attr('x', reverse ? x1 : 0);\n\n        measure\n          .transition()\n          .duration(duration)\n          .attr('width', w1)\n          .attr('height', height / 3)\n          .attr('x', reverse ? x1 : 0)\n          .attr('y', height / 3);\n\n        // Update the marker lines.\n        var marker = g.selectAll('line.marker').data(markerz);\n\n        marker\n          .enter()\n          .append('line')\n          .attr('class', 'marker')\n          .attr('x1', x0)\n          .attr('x2', x0)\n          .attr('y1', height / 6)\n          .attr('y2', (height * 5) / 6)\n          .transition()\n          .duration(duration)\n          .attr('x1', x1)\n          .attr('x2', x1);\n\n        marker\n          .transition()\n          .duration(duration)\n          .attr('x1', x1)\n          .attr('x2', x1)\n          .attr('y1', height / 6)\n          .attr('y2', (height * 5) / 6);\n\n        // Compute the tick format.\n        var format = tickFormat || x1.tickFormat(8);\n\n        // Update the tick groups.\n        var tick = g.selectAll('g.tick').data(x1.ticks(8), function(d) {\n          return this.textContent || format(d);\n        });\n\n        // Initialize the ticks with the old scale, x0.\n        var tickEnter = tick\n          .enter()\n          .append('g')\n          .attr('class', 'tick')\n          .attr('transform', bulletTranslate(x0))\n          .style('opacity', 1e-6);\n\n        tickEnter\n          .append('line')\n          .attr('y1', height)\n          .attr('y2', (height * 7) / 6);\n\n        tickEnter\n          .append('text')\n          .attr('text-anchor', 'middle')\n          .attr('dy', '1em')\n          .attr('y', (height * 7) / 6)\n          .text(format);\n\n        // Transition the entering ticks to the new scale, x1.\n        tickEnter\n          .transition()\n          .duration(duration)\n          .attr('transform', bulletTranslate(x1))\n          .style('opacity', 1);\n\n        // Transition the updating ticks to the new scale, x1.\n        var tickUpdate = tick\n          .transition()\n          .duration(duration)\n          .attr('transform', bulletTranslate(x1))\n          .style('opacity', 1);\n\n        tickUpdate\n          .select('line')\n          .attr('y1', height)\n          .attr('y2', (height * 7) / 6);\n\n        tickUpdate.select('text').attr('y', (height * 7) / 6);\n\n        // Transition the exiting ticks to the new scale, x1.\n        tick\n          .exit()\n          .transition()\n          .duration(duration)\n          .attr('transform', bulletTranslate(x1))\n          .style('opacity', 1e-6)\n          .remove();\n      });\n      d3.timerFlush();\n    }\n\n    // left, right, top, bottom\n    bullet.orient = function(x) {\n      if (!arguments.length) return orient;\n      orient = x;\n      reverse = orient == 'right' || orient == 'bottom';\n      return bullet;\n    };\n\n    // ranges (bad, satisfactory, good)\n    bullet.ranges = function(x) {\n      if (!arguments.length) return ranges;\n      ranges = x;\n      return bullet;\n    };\n\n    // markers (previous, goal)\n    bullet.markers = function(x) {\n      if (!arguments.length) return markers;\n      markers = x;\n      return bullet;\n    };\n\n    // measures (actual, forecast)\n    bullet.measures = function(x) {\n      if (!arguments.length) return measures;\n      measures = x;\n      return bullet;\n    };\n\n    bullet.width = function(x) {\n      if (!arguments.length) return width;\n      width = x;\n      return bullet;\n    };\n\n    bullet.height = function(x) {\n      if (!arguments.length) return height;\n      height = x;\n      return bullet;\n    };\n\n    bullet.tickFormat = function(x) {\n      if (!arguments.length) return tickFormat;\n      tickFormat = x;\n      return bullet;\n    };\n\n    bullet.duration = function(x) {\n      if (!arguments.length) return duration;\n      duration = x;\n      return bullet;\n    };\n\n    return bullet;\n  },\n};\n\nfunction bulletRanges(d) {\n  return d.ranges;\n}\n\nfunction bulletMarkers(d) {\n  return d.markers;\n}\n\nfunction bulletMeasures(d) {\n  return d.measures;\n}\n\nfunction bulletTranslate(x) {\n  return function(d) {\n    return 'translate(' + x(d) + ',0)';\n  };\n}\n\nfunction bulletWidth(x) {\n  var x0 = x(0);\n  return function(d) {\n    return Math.abs(x(d) - x0);\n  };\n}\n"]},"metadata":{},"sourceType":"module"}