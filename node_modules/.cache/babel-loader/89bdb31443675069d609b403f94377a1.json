{"ast":null,"code":"var _jsxFileName = \"/Users/jim/Source/CD/JavaScript/D3/D3-playground/src/components/BarCharts/AnimatedHorizontalBar/index.jsx\";\nimport React, { useEffect } from 'react';\nimport * as d3 from 'd3';\nimport { scaleLinear, scaleOrdinal, scaleBand } from 'd3-scale';\nimport './style.css';\nimport { data } from './data';\nconst margin = {\n  top: 20,\n  right: 40,\n  bottom: 10,\n  left: 40\n};\nconst width = 960;\nconst height = 250 - margin.top - margin.bottom;\nconst format = d3.format('.1%');\nlet chart;\nlet age;\nlet menu;\nconst x = d3.scaleLinear().range([0, width]);\nconst y = d3.scaleBand().rangeRound([0, height]).padding(0.05);\nconst xAxis = d3.axisTop(x).tickSize(-height - margin.bottom).tickFormat(format);\nconst states = data;\nconst ages = d3.keys(states[0]).filter(key => key !== 'State' && key !== 'Total');\n\nconst AnimatedHorizontalBar = () => {\n  useEffect(() => {\n    chart = d3.select('#Popchart').append('svg').attr('width', width + margin.left + margin.right).attr('height', height + margin.top + margin.bottom).style('margin-left', \"\".concat(-margin.left, \"px\")).append('g').attr('transform', \"translate(\".concat(margin.left, \",\").concat(margin.top, \")\"));\n    chart.append('g').attr('class', 'x Caxis');\n    chart.append('g').attr('class', 'y Caxis').append('line').attr('class', 'domain').attr('y2', height);\n    menu = d3.select('#menu select').on('change', redraw);\n    menu.selectAll('option').data(ages).enter().append('option').text(d => d);\n    menu.property('value', '18 to 24 Years');\n    redraw();\n  });\n\n  function redraw() {\n    const t = d3.transition().duration(1000);\n    let age1 = menu.property('value');\n    const top = states.sort((a, b) => b[age1] - a[age1]).slice(0, 5);\n    y.domain(top.map(d => d.State));\n    x.domain([0, top[0][age1]]);\n    let bar = chart.selectAll('.bar').data(top, d => d.State);\n    bar.join(enter => {\n      let barEnter = enter.insert('g', '.Caxis').attr('class', 'bar').attr('transform', \"translate(0, \".concat(height, \")\")).style('fill-opacity', 0);\n      barEnter.append('rect').attr('width', d => x(d[age1])).attr('height', y.bandwidth());\n      barEnter.append('text').attr('class', 'label').attr('x', -3).attr('y', y.bandwidth() / 2).attr('dy', '.35em').attr('text-anchor', 'end').text(d => d.State);\n      barEnter.append('text').attr('class', 'value').attr('x', d => x(d[age1]) - 3).attr('y', y.bandwidth() / 2).attr('dy', '.35em').attr('text-anchor', 'end').text(d => format(d[age1]));\n      barEnter.call(barEnter => barEnter.transition(t).attr('transform', d => \"translate(0, \".concat(y(d.State), \")\")).style('fill-opacity', 1));\n    }, update => {\n      update.transition(t).select('.value').attr('x', d => x(d[age1]) - 3).text(d => format(d[age1]));\n      update.call(update => update.transition(t).attr('transform', d => \"translate(0, \".concat(y(d.State), \")\")).style('fill-opacity', 1).select('rect').attr('width', d => x(d[age1])));\n    }, exit => {\n      exit.call(exit => exit.transition(t).attr('transform', d => \"translate(0, \".concat(height, \")\")).style('fill-opacity', 0).remove());\n    });\n    d3.transition(t).select('.x.Caxis').call(xAxis);\n  }\n\n  return React.createElement(React.Fragment, null, React.createElement(\"p\", {\n    id: \"Popchart\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 150\n    },\n    __self: this\n  }), React.createElement(\"p\", {\n    id: \"menu\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 151\n    },\n    __self: this\n  }, React.createElement(\"b\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 152\n    },\n    __self: this\n  }, \"Top States by Age Bracket, 2008\"), React.createElement(\"br\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 153\n    },\n    __self: this\n  }), \"Age: \", React.createElement(\"select\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 154\n    },\n    __self: this\n  })));\n};\n\nexport default AnimatedHorizontalBar;","map":{"version":3,"sources":["/Users/jim/Source/CD/JavaScript/D3/D3-playground/src/components/BarCharts/AnimatedHorizontalBar/index.jsx"],"names":["React","useEffect","d3","scaleLinear","scaleOrdinal","scaleBand","data","margin","top","right","bottom","left","width","height","format","chart","age","menu","x","range","y","rangeRound","padding","xAxis","axisTop","tickSize","tickFormat","states","ages","keys","filter","key","AnimatedHorizontalBar","select","append","attr","style","on","redraw","selectAll","enter","text","d","property","t","transition","duration","age1","sort","a","b","slice","domain","map","State","bar","join","barEnter","insert","bandwidth","call","update","exit","remove"],"mappings":"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","sourcesContent":["import React, { useEffect } from 'react';\nimport * as d3 from 'd3';\nimport { scaleLinear, scaleOrdinal, scaleBand } from 'd3-scale';\nimport './style.css';\nimport { data } from './data';\n\nconst margin = { top: 20, right: 40, bottom: 10, left: 40 };\nconst width = 960;\nconst height = 250 - margin.top - margin.bottom;\n\nconst format = d3.format('.1%');\nlet chart;\nlet age;\nlet menu;\n\nconst x = d3.scaleLinear().range([0, width]);\n\nconst y = d3\n  .scaleBand()\n  .rangeRound([0, height])\n  .padding(0.05);\n\nconst xAxis = d3\n  .axisTop(x)\n  .tickSize(-height - margin.bottom)\n  .tickFormat(format);\n\nconst states = data;\n\nconst ages = d3\n  .keys(states[0])\n  .filter(key => key !== 'State' && key !== 'Total');\n\nconst AnimatedHorizontalBar = () => {\n  useEffect(() => {\n    chart = d3\n      .select('#Popchart')\n      .append('svg')\n      .attr('width', width + margin.left + margin.right)\n      .attr('height', height + margin.top + margin.bottom)\n      .style('margin-left', `${-margin.left}px`)\n      .append('g')\n      .attr('transform', `translate(${margin.left},${margin.top})`);\n\n    chart.append('g').attr('class', 'x Caxis');\n\n    chart\n      .append('g')\n      .attr('class', 'y Caxis')\n      .append('line')\n      .attr('class', 'domain')\n      .attr('y2', height);\n\n    menu = d3.select('#menu select').on('change', redraw);\n\n    menu\n      .selectAll('option')\n      .data(ages)\n      .enter()\n      .append('option')\n      .text(d => d);\n\n    menu.property('value', '18 to 24 Years');\n\n    redraw();\n  });\n\n  function redraw() {\n    const t = d3.transition().duration(1000);\n    let age1 = menu.property('value');\n    const top = states.sort((a, b) => b[age1] - a[age1]).slice(0, 5);\n\n    y.domain(top.map(d => d.State));\n    x.domain([0, top[0][age1]]);\n\n    let bar = chart.selectAll('.bar').data(top, d => d.State);\n\n    bar.join(\n      enter => {\n        let barEnter = enter\n          .insert('g', '.Caxis')\n          .attr('class', 'bar')\n          .attr('transform', `translate(0, ${height})`)\n          .style('fill-opacity', 0);\n\n        barEnter\n          .append('rect')\n          .attr('width', d => x(d[age1]))\n          .attr('height', y.bandwidth());\n\n        barEnter\n          .append('text')\n          .attr('class', 'label')\n          .attr('x', -3)\n          .attr('y', y.bandwidth() / 2)\n          .attr('dy', '.35em')\n          .attr('text-anchor', 'end')\n          .text(d => d.State);\n\n        barEnter\n          .append('text')\n          .attr('class', 'value')\n          .attr('x', d => x(d[age1]) - 3)\n          .attr('y', y.bandwidth() / 2)\n          .attr('dy', '.35em')\n          .attr('text-anchor', 'end')\n          .text(d => format(d[age1]));\n\n        barEnter.call(barEnter =>\n          barEnter\n            .transition(t)\n            .attr('transform', d => `translate(0, ${y(d.State)})`)\n            .style('fill-opacity', 1)\n        );\n      },\n      update => {\n        update\n          .transition(t)\n          .select('.value')\n          .attr('x', d => x(d[age1]) - 3)\n          .text(d => format(d[age1]));\n\n        update.call(update =>\n          update\n            .transition(t)\n            .attr('transform', d => `translate(0, ${y(d.State)})`)\n            .style('fill-opacity', 1)\n            .select('rect')\n            .attr('width', d => x(d[age1]))\n        );\n      },\n      exit => {\n        exit.call(exit =>\n          exit\n            .transition(t)\n            .attr('transform', d => `translate(0, ${height})`)\n            .style('fill-opacity', 0)\n            .remove()\n        );\n      }\n    );\n\n    d3.transition(t)\n      .select('.x.Caxis')\n      .call(xAxis);\n  }\n\n  return (\n    <>\n      <p id=\"Popchart\" />\n      <p id=\"menu\">\n        <b>Top States by Age Bracket, 2008</b>\n        <br />\n        Age: <select></select>\n      </p>\n    </>\n  );\n};\n\nexport default AnimatedHorizontalBar;\n"]},"metadata":{},"sourceType":"module"}