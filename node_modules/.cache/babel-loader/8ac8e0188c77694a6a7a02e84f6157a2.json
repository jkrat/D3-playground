{"ast":null,"code":"var _jsxFileName = \"/Users/jim/Source/CD/JavaScript/D3/D3-playground/src/components/BarCharts/Grouped/index.jsx\";\nimport React, { useEffect } from 'react';\nimport * as d3 from 'd3';\nimport { data } from './data';\nconst margin = {\n  top: 10,\n  right: 10,\n  bottom: 20,\n  left: 40\n};\nconst width = 960 - margin.left - margin.right;\nconst height = 500 - margin.top - margin.bottom;\nconst color = d3.scaleOrdinal().range(['#98abc5', '#8a89a6', '#7b6888', '#6b486b', '#a05d56', '#d0743c', '#ff8c00']);\nconst groupKey = Object.keys(data[0])[0];\nconst keys = Object.keys(data[0]).slice(1);\nconst x0 = d3.scaleBand().domain(data.map(d => d[groupKey])).rangeRound([margin.left, width - margin.right]).paddingInner(0.1);\nconst x1 = d3.scaleBand().domain(keys).rangeRound([0, x0.bandwidth()]).padding(0.05);\nconst y = d3.scaleLinear().domain([0, d3.max(data, d => d3.max(keys, key => d[key]))]).nice().rangeRound([height - margin.bottom, margin.top]);\n\nconst xAxis = g => g.attr('transform', \"translate(0,\".concat(height - margin.bottom, \")\")).call(d3.axisBottom(x0).tickSizeOuter(0)).call(g => g.select('.domain').remove());\n\nconst yAxis = g => g.attr('transform', \"translate(\".concat(margin.left, \",0)\")).call(d3.axisLeft(y).ticks(null, 's')).call(g => g.select('.domain').remove());\n\nconst legend = svg => {\n  const g = svg.attr('transform', \"translate(\".concat(width, \",0)\")).attr('text-anchor', 'end').attr('font-family', 'sans-serif').attr('font-size', 10).selectAll('g').data(color.domain().slice().reverse()).join('g').attr('transform', (d, i) => \"translate(0,\".concat(i * 20, \")\"));\n  g.append('rect').attr('x', -19).attr('width', 19).attr('height', 19).attr('fill', color);\n  g.append('text').attr('x', -24).attr('y', 9.5).attr('dy', '0.35em').text(d => d);\n};\n\nconst Grouped = () => {\n  useEffect(() => {\n    const chart = d3.select('#Grouped').attr('width', width + margin.left + margin.right).attr('height', height + margin.top + margin.bottom).append('g').attr('transform', \"translate(\".concat(margin.left, \",\").concat(margin.top, \")\"));\n    chart.selectAll('g').data(data).join('g').attr('transform', d => \"translate(\".concat(x0(d[groupKey]), \",0)\")).selectAll('rect').data(d => keys.map(key => ({\n      key,\n      value: d[key]\n    }))).join('rect').attr('x', d => x1(d.key)).attr('y', d => y(d.value)).attr('width', x1.bandwidth()).attr('height', d => y(0) - y(d.value)).attr('fill', d => color(d.key));\n    chart.append('g').call(xAxis);\n    chart.append('g').call(yAxis);\n    chart.append('g').call(legend);\n  });\n  return React.createElement(\"svg\", {\n    id: \"Grouped\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 113\n    },\n    __self: this\n  });\n};\n\nexport default Grouped;","map":{"version":3,"sources":["/Users/jim/Source/CD/JavaScript/D3/D3-playground/src/components/BarCharts/Grouped/index.jsx"],"names":["React","useEffect","d3","data","margin","top","right","bottom","left","width","height","color","scaleOrdinal","range","groupKey","Object","keys","slice","x0","scaleBand","domain","map","d","rangeRound","paddingInner","x1","bandwidth","padding","y","scaleLinear","max","key","nice","xAxis","g","attr","call","axisBottom","tickSizeOuter","select","remove","yAxis","axisLeft","ticks","legend","svg","selectAll","reverse","join","i","append","text","Grouped","chart","value"],"mappings":"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","sourcesContent":["import React, { useEffect } from 'react';\nimport * as d3 from 'd3';\nimport { data } from './data';\n\nconst margin = { top: 10, right: 10, bottom: 20, left: 40 };\nconst width = 960 - margin.left - margin.right;\nconst height = 500 - margin.top - margin.bottom;\n\nconst color = d3\n  .scaleOrdinal()\n  .range([\n    '#98abc5',\n    '#8a89a6',\n    '#7b6888',\n    '#6b486b',\n    '#a05d56',\n    '#d0743c',\n    '#ff8c00',\n  ]);\n\nconst groupKey = Object.keys(data[0])[0];\nconst keys = Object.keys(data[0]).slice(1);\n\nconst x0 = d3\n  .scaleBand()\n  .domain(data.map(d => d[groupKey]))\n  .rangeRound([margin.left, width - margin.right])\n  .paddingInner(0.1);\n\nconst x1 = d3\n  .scaleBand()\n  .domain(keys)\n  .rangeRound([0, x0.bandwidth()])\n  .padding(0.05);\n\nconst y = d3\n  .scaleLinear()\n  .domain([0, d3.max(data, d => d3.max(keys, key => d[key]))])\n  .nice()\n  .rangeRound([height - margin.bottom, margin.top]);\n\nconst xAxis = g =>\n  g\n    .attr('transform', `translate(0,${height - margin.bottom})`)\n    .call(d3.axisBottom(x0).tickSizeOuter(0))\n    .call(g => g.select('.domain').remove());\n\nconst yAxis = g =>\n  g\n    .attr('transform', `translate(${margin.left},0)`)\n    .call(d3.axisLeft(y).ticks(null, 's'))\n    .call(g => g.select('.domain').remove());\n\nconst legend = svg => {\n  const g = svg\n    .attr('transform', `translate(${width},0)`)\n    .attr('text-anchor', 'end')\n    .attr('font-family', 'sans-serif')\n    .attr('font-size', 10)\n    .selectAll('g')\n    .data(\n      color\n        .domain()\n        .slice()\n        .reverse()\n    )\n    .join('g')\n    .attr('transform', (d, i) => `translate(0,${i * 20})`);\n\n  g.append('rect')\n    .attr('x', -19)\n    .attr('width', 19)\n    .attr('height', 19)\n    .attr('fill', color);\n\n  g.append('text')\n    .attr('x', -24)\n    .attr('y', 9.5)\n    .attr('dy', '0.35em')\n    .text(d => d);\n};\n\nconst Grouped = () => {\n  useEffect(() => {\n    const chart = d3\n      .select('#Grouped')\n      .attr('width', width + margin.left + margin.right)\n      .attr('height', height + margin.top + margin.bottom)\n      .append('g')\n      .attr('transform', `translate(${margin.left},${margin.top})`);\n\n    chart\n      .selectAll('g')\n      .data(data)\n      .join('g')\n      .attr('transform', d => `translate(${x0(d[groupKey])},0)`)\n      .selectAll('rect')\n      .data(d => keys.map(key => ({ key, value: d[key] })))\n      .join('rect')\n      .attr('x', d => x1(d.key))\n      .attr('y', d => y(d.value))\n      .attr('width', x1.bandwidth())\n      .attr('height', d => y(0) - y(d.value))\n      .attr('fill', d => color(d.key));\n\n    chart.append('g').call(xAxis);\n\n    chart.append('g').call(yAxis);\n\n    chart.append('g').call(legend);\n  });\n\n  return <svg id=\"Grouped\"></svg>;\n};\n\nexport default Grouped;\n"]},"metadata":{},"sourceType":"module"}